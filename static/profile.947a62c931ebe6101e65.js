(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{131:function(e,n,t){"use strict";t.r(n);var a,o=t(0),i=t.n(o),s=t(4),c=t(10),r=[new c.d,new c.f,new c.b],d={};!function(){var e,n,t,a,o,s,c,l,u,p,f,m,h,v,g=i()("form#inbox-tools-form"),b=i()("#compose.message-composition");b.length>0&&(e=b.find(".modal-message"),n=b.find("#compose-form"),t=n.find("textarea#compose-message"),a=n.find("input#compose-recipients"),o=n.find(".modal-recipients .recipient-container"),s=n.find("button#modal-send-btn"),c=n.find("button#modal-close-btn"),l=n.find(".modal-user-groups"),u=!1,p=function(){n.find("button,input,textarea").removeAttr("disabled")},f=function(){var a=t.val(),o=v();0!==o.length?""!==a.trim()?a.trim().length>500?e.show().html('<span class="text-danger">Your message cannot be longer than 500 characters</span>'):(n.find("button,input,textarea").attr("disabled","disabled"),e.show().html('<i class="fas fa-cog fa-spin"></i> Sending message ...'),u=!0,i.a.ajax({type:"post",url:"/profile/messages/send",data:{recipients:o,message:a}}).always(function(){return u=!1}).fail(function(n){return e.show().html('<span class="text-danger">'.concat(n.status,": ").concat(n.statusText,"</span>"))}).done(function(n){!0===n.success?(i()(document).alertSuccess("Your message has been sent.",{delay:3e3}),b.modal("hide")):(e.show().html('<span class="text-danger">'.concat(n.message,"</span>")),p())})):e.show().html('<span class="text-danger">Message required</span>'):e.show().html('<span class="text-danger">Recipients required</span>')},m=function(e){return e.split(" ").filter(function(e){return 0===e.search(/^[A-Z0-9_]{3,20}$/i)})},h=function(e,n){var t=e.toLowerCase();n=["recipient",n],o.find('.recipient[data-recipient="'+t+'"]').get(0)||o.append(""+'<span class="'.concat(n.join(" "),'" data-recipient="').concat(t,'">')+'<span class="recipient-name">'.concat(e,"</span>")+'<i class="glyphicon glyphicon-remove remove-recipient" title="Remove"></i></span>')},v=function(){return o.find(".recipient").get().map(function(e){return i()(e).data("recipient")})},b.on("keydown",function(){return e.hide()}),b.on("shown.bs.modal",function(e){return i()(e.currentTarget).find("input#compose-recipients").focus()}),b.on("hidden.bs.modal",function(){u||(t.val(""),a.val(""),o.empty(),e.hide(),p())}),b.on("click",".remove-recipient",function(e){return i()(e.currentTarget).closest(".recipient").remove()}),b.on("change","input#compose-recipients",function(){m(i()(this).val()).forEach(h),a.val("")}),b.on("keypress","input#compose-recipients",function(e){var n=e.which;(32===n||13===n||/[;:,']/i.test(String.fromCharCode(n)))&&(m(i()(this).val()).forEach(h),a.val(""),e.preventDefault(),e.stopPropagation()),a.focus()}),c.on("click",function(){return b.modal("hide")}),s.on("click",f),t.on("keydown",function(e){e.ctrlKey&&13===e.keyCode&&(f(),e.preventDefault(),e.stopPropagation())}),l.on("click",".groups a",function(e){return h(i()(e.currentTarget).text(),"group")}),i()("#inbox-message-reply").on("click",function(e){b.unbind("shown.bs.modal").on("shown.bs.modal",function(e){return i()(e.currentTarget).find("textarea").focus()}),b.find("#composeLabel").text("Reply ..."),b.find(".modal-recipients,.modal-settings,.modal-user-groups").hide(),a.val(""),o.empty(),h(i()(e.currentTarget).data("replyto"))}));var y=function(e,n,t){!n||n.length<t?e.text("The End").prop("disabled",!0).attr("class","btn btn btn-dark").show():e.text("Show more").prop("disabled",!1).attr("class","btn btn-primary").show()},w=i()("#inbox-list");w.length>0&&function(){var e=i()("#inbox-tools"),n=e.find("#inbox-toggle-select"),t=e.find("#inbox-read-selected"),a=e.find("#inbox-delete-selected"),o=i()("#inbox-list-more"),s=i()("#inbox-loading"),c=i()("#inbox-empty"),l=i()("#inbox-modal-delete"),u=0,p=function(){var e=0===f().length;t.prop("disabled",e),a.prop("disabled",e)},f=function(){return w.find("td.selector.active").toArray()},m=function(){i()(this).addClass("active").find("i").attr("class","far fa-dot-circle"),p()},h=function(){i()(this).removeClass("active").find("i").attr("class","far fa-circle"),p()},v=function(e){var n=i()(this);e.preventDefault(),e.stopPropagation(),n.hasClass("active")?h.apply(n):m.apply(n)},b=function(e){var n=i()(this).data("id");void 0!==n&&(e.preventDefault(),e.stopPropagation(),window.location.href="/profile/messages/"+encodeURIComponent(n))},x=function(){i()(this).addClass("pressed")},k=function(){i()(this).removeClass("pressed")};w.each(function(e,n){i()(n).on("click","tbody tr",b).on("click","tbody td.selector",v).on("mousedown","tbody tr",x).on("mouseup","tbody tr",k)}),n.on("click touch",function(e){return w.find(".selector").each(function(){var e=i()(this);e.hasClass("active")?h.apply(e):m.apply(e)}),!1}),t.on("click touch",function(){var e=f().map(function(e){return i()(e).closest("tr").data("id")});return g.attr("action","/profile/messages/read").append(e.map(function(e){return'<input type="hidden" name="selected[]" value="'.concat(e,'" />')})).submit(),!1}),a.on("click touch",function(){var e=f().map(function(e){return i()(e).closest("tr").data("id")}),n=l.find("button");l.find(".modal-body").html("<div>Are you sure you want to delete ".concat(e.length," conversation(s)?</div>")+"<div>This cannot be undone.</div>"),l.on("click touch","#deleteConversation",function(){n.prop("disabled",!0),g.attr("action","/profile/messages/delete").append(e.map(function(e){return'<input type="hidden" name="selected[]" value="'.concat(e,'" />')})).submit()}),l.modal("show")});var C=function(e){var n=e.message.trim();return r.forEach(function(e){return n=e.format(d,n)}),'<tr data-id="'.concat(e.userid,'" data-username="').concat(e.user,'" class="').concat(e.unread<=0?"read":"unread",'">')+'<td class="selector"><i class="far fa-circle"></i></td><td class="from">'+'<a href="/profile/messages/'.concat(e.userid,'">').concat(e.user,"</a> ")+'<span class="count">('.concat(e.unread>0?e.unread:parseInt(e.read)+parseInt(e.unread),")</span>")+"</td>"+'<td class="message-txt"><span>'.concat(n,"</span></td>")+'<td class="timestamp"><time data-moment>'.concat(e.timestamp,"</time></td>")+"</tr>"},T=function(e){u+=25,w.find("table#inbox-message-grid tbody").append((e||[]).map(C).join("")),y(o,e,25),c.toggle(25===u&&0===e.length),s.fadeOut(),window.applyMomentToElements()},j=function(){return s.fadeIn(),i.a.ajax({url:"/api/messages/inbox",data:{s:u}}).always(T)};o.on("click",j),j()}();var x=i()("#message-list");if(x.length>0){var k=x.data("userid"),C=x.data("username"),T=i()("#inbox-loading"),j=i()("#inbox-list-more"),A=i()("#inbox-delete-selected"),D=i()("#inbox-empty"),E=i()("#inbox-modal-delete"),I=0,R=function(e){var n=e.message.trim();r.forEach(function(e){return n=e.format(d,n)});var t=parseInt(k)!==parseInt(e.userid),a=[];return a.push("message-active"),a.push("message-"+(t?"me":"notme")),a.push(1===e.isread?"message-read":"message-unread"),'<tr data-id="'.concat(e.id,'" data-username="').concat(e.from,'" class="').concat(a.join(" "),'">')+'<td class="message"><div class="message-header"><div class="from">'+'<i title="'.concat(e.isread?"Opened":"Unopened",'" class="fa fa-fw fa-dgg-').concat(e.isread?"read":"unread",'"></i>')+'<div class="username">'.concat(e.from,"</div>")+'<time class="timestamp" data-moment data-moment-fromnow="true">'.concat(e.timestamp,"</time>")+"</div>"+'<time class="timestamp" data-moment>'.concat(e.timestamp,"</time>")+"</div>"+'<div class="message-txt">'.concat(n,"</div>")+"</td></tr>"},P=function(e){I+=25,x.find("table#inbox-message-grid tbody").append((e.length?e:[]).map(R).join("")),y(j,e,25),D.toggle(25===I&&0===e.length),T.fadeOut(),window.applyMomentToElements()},S=function(){return T.fadeIn(),i.a.ajax({url:"/api/messages/usr/".concat(encodeURIComponent(C.toLowerCase()),"/inbox"),data:{s:I}}).always(P)};j.on("click",S),S(),A.on("click touch",function(){var e=[x.data("userid")];E.find(".modal-body").html("<div>Are you sure you want to delete this entire conversation?</div><div>This cannot be undone.</div>"),E.on("click touch","#deleteConversation",function(){g.attr("action","/profile/messages/delete").append(e.map(function(e){return'<input type="hidden" name="selected[]" value="'.concat(e,'" />')})).submit()}),E.modal("show")}),i()("#inbox-scroll-bottom").on("click",function(){return window.scrollTo(0,document.body.scrollHeight),!1}),i()("#inbox-scroll-top").on("click",function(){return window.scrollTo(0,0),!1})}}(),(a=i()("form#nameForm")).each(function(){var e=i()("input#nameChange"),n=i()("#nameChangeAlert"),t=i()("#nameChangeBackDrop"),o=n.find("p").html(),c=!1;n.on("click",function(){return c&&a.submit(),!1}),t.on("click",function(){return e.blur().focus(),!1}),e.on("change keyup",Object(s.a)(250,!1,function(){var t=e.val();""!==t?i.a.ajax({url:"/profile/usernamecheck",data:{username:t},type:"GET",success:function(e){if(e)if(!0===e.success)n.removeClass("alert-danger").addClass("alert-success"),n.find("p").html('<i class="fas fa-fw fa-check-circle"></i>&nbsp;Click <strong>here</strong> to confirm your username!'),c=!0;else{n.removeClass("alert-success").addClass("alert-danger");var t=e.error?e.error:"Username already exists, try another!";n.find("p").html('<i class="fas fa-fw fa-times-circle"></i>&nbsp;'+t)}else n.removeClass("alert-success").addClass("alert-danger")}}):n.find("p").html(o)}))}),function(){var e=i()("#connections-content"),n=i()("#connectSelectToggleBtn"),t=(i()("#connectNewConnBtn"),i()("#connectRemoveBtn")),a=(i()("#connectModal"),i()("#connectToolsForm"));if(e.length>0){var o=function(){var e=0===s().length;t.prop("disabled",e)},s=function(){return e.find("td.selector.active").toArray()},c=function(){i()(this).addClass("active").find("i").attr("class","far fa-dot-circle"),o()},r=function(){i()(this).removeClass("active").find("i").attr("class","far fa-circle"),o()};n.on("click touch",function(n){return e.find(".selector").each(function(){var e=i()(this);e.hasClass("active")?r.apply(e):c.apply(e)}),!1}),t.on("click",function(){if(confirm("Are you sure? This cannot be undone!")){var e=s().map(function(e){return i()(e).closest("tr").data("id")});return a.attr("action","/profile/remove").append(e.map(function(e){return'<input type="hidden" name="selected[]" value="'.concat(e,'" />')})).submit(),!1}}),e.on("click","tbody td.selector",function(e){var n=i()(this);e.preventDefault(),e.stopPropagation(),n.hasClass("active")?r.apply(n):c.apply(n)})}}()},4:function(e,n,t){"use strict";function a(e,n,t,a){var o,i=!1,s=0;function c(){o&&clearTimeout(o)}function r(){var r=this,d=Date.now()-s,l=arguments;function u(){s=Date.now(),t.apply(r,l)}i||(a&&!o&&u(),c(),void 0===a&&d>e?u():!0!==n&&(o=setTimeout(a?function(){o=void 0}:u,void 0===a?e-d:e)))}return"boolean"!=typeof n&&(a=t,t=n,n=void 0),r.cancel=function(){c(),i=!0},r}function o(e,n,t){return void 0===t?a(e,n,!1):a(e,t,!1!==n)}t.d(n,"b",function(){return a}),t.d(n,"a",function(){return o})}},[[131,1,0,2]]]);